[
  {
    "id": "RUSTSEC-2026-0001",
    "modified": "2026-01-06T15:33:19Z",
    "published": "2026-01-05T12:00:00Z",
    "aliases": [],
    "related": [],
    "summary": "Potential Undefined Behaviors in `Arc<T>`/`Rc<T>` impls of `from_value` on OOM",
    "details": "The `SharedPointer::alloc` implementation for `sync::Arc<T>` and `rc::Rc<T>` in `rkyv/src/impls/alloc/rc/atomic.rs` (and `rc.rs`) does not check if the allocator returns a null pointer on OOM (Out of Memory).\n\nThis null pointer can flow through to `SharedPointer::from_value`, which calls `Box::from_raw(ptr)` with the null pointer. This triggers undefined behavior when utilizing safe deserialization APIs (such as `rkyv::from_bytes` or `rkyv::deserialize_using`) if an OOM condition occurs during the allocation of the shared pointer.\n\nThe issue is reachable through safe code and violates Rust's safety guarantees.",
    "severity": [],
    "affected": [
      {
        "package": {
          "ecosystem": "crates.io",
          "name": "rkyv",
          "purl": "pkg:cargo/rkyv"
        },
        "ecosystem_specific": {
          "affects": {
            "arch": [],
            "os": [],
            "functions": []
          },
          "affected_functions": null
        },
        "database_specific": {
          "categories": [
            "memory-corruption"
          ],
          "cvss": null,
          "informational": null
        },
        "ranges": [
          {
            "type": "SEMVER",
            "events": [
              {
                "introduced": "0.0.0-0"
              },
              {
                "fixed": "0.7.46"
              },
              {
                "introduced": "0.8.0"
              },
              {
                "fixed": "0.8.13"
              }
            ]
          }
        ],
        "versions": []
      }
    ],
    "references": [
      {
        "type": "PACKAGE",
        "url": "https://crates.io/crates/rkyv"
      },
      {
        "type": "ADVISORY",
        "url": "https://rustsec.org/advisories/RUSTSEC-2026-0001.html"
      },
      {
        "type": "REPORT",
        "url": "https://github.com/rkyv/rkyv/issues/644"
      }
    ],
    "database_specific": {
      "license": "CC0-1.0"
    }
  },
  {
    "id": "RUSTSEC-2021-0054",
    "modified": "2023-06-13T13:10:24Z",
    "published": "2021-04-28T12:00:00Z",
    "aliases": [
      "CVE-2021-31919",
      "GHSA-w5cr-frph-hw7f"
    ],
    "related": [],
    "summary": "Archives may contain uninitialized memory",
    "details": "`rkyv` is a serialization framework that writes struct-compatible memory to be stored or\ntransmitted. During serialization, struct padding bytes and unused enum bytes may not be\ninitialized. These bytes may be written to disk or sent over unsecured channels.",
    "severity": [
      {
        "type": "CVSS_V3",
        "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N"
      }
    ],
    "affected": [
      {
        "package": {
          "ecosystem": "crates.io",
          "name": "rkyv",
          "purl": "pkg:cargo/rkyv"
        },
        "ecosystem_specific": {
          "affects": {
            "arch": [],
            "os": [],
            "functions": [
              "rkyv::Archive::resolve"
            ]
          },
          "affected_functions": null
        },
        "database_specific": {
          "categories": [
            "memory-exposure"
          ],
          "cvss": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "informational": null
        },
        "ranges": [
          {
            "type": "SEMVER",
            "events": [
              {
                "introduced": "0.0.0-0"
              },
              {
                "fixed": "0.6.0"
              }
            ]
          }
        ],
        "versions": []
      }
    ],
    "references": [
      {
        "type": "PACKAGE",
        "url": "https://crates.io/crates/rkyv"
      },
      {
        "type": "ADVISORY",
        "url": "https://rustsec.org/advisories/RUSTSEC-2021-0054.html"
      },
      {
        "type": "REPORT",
        "url": "https://github.com/djkoloski/rkyv/issues/113"
      }
    ],
    "database_specific": {
      "license": "CC0-1.0"
    }
  }
]