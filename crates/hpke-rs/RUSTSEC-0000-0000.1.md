```toml
[advisory]
id = "RUSTSEC-0000-0000"
related = ["GHSA-g433-pq76-6cmf"]
package = "hpke-rs"
date = "2026-02-10"
url = "https://github.com/cryspen/hpke-rs/pull/117"
cvss = "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:N/VA:N/SC:L/SI:N/SA:N"
categories = ["crypto-failure"]
keywords = ["x25519", "hpke", "validation"]
references = ["https://datatracker.ietf.org/doc/rfc9180/"]

[versions]
patched = [">=0.6.0"]
```

# Missing mandatory X25519 all-zero output validation in HPKE

RFC 9180, Section 7.1.4 mandates that HPKE implementations "MUST check whether the Diffie-Hellman shared secret is the all-zero value and abort if so." This check is required because the X25519 function, when given certain low-order points as input (the identity element, points of small order), produces an all-zero output.

The hpke-rs library's Diffie-Hellman implementation, in both the RustCrypto and libcrux provider backends, returns the raw output of the X25519 computation without performing this validation. The result flows directly into `extract_and_expand()`, which derives HPKE session keys from the shared secret.

An attacker who can supply a malicious public key containing a low-order point can force the shared secret to zero, making the HPKE key schedule deterministic and predictable. The attacker can then compute the same session keys as the sender and decrypt all messages.

This vulnerability was originally disclosed as https://github.com/cryspen/hpke-rs/pull/117
