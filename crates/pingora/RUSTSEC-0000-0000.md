```toml
[advisory]
id = "RUSTSEC-0000-0000"
package = "pingora"
date = "2025-05-22"
url = "https://blog.cloudflare.com/resolving-a-request-smuggling-vulnerability-in-pingora/"
# Valid categories: "code-execution", "crypto-failure", "denial-of-service", "file-disclosure"
# "format-injection", "memory-corruption", "memory-exposure", "privilege-escalation"
categories = []
keywords = ["request-smuggling", "cache-poisoning"]
#aliases = ["CVE-YYYY-NNNN"]
#cvss = "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H"

[versions]
patched = [">= 0.5.0"]
unaffected = []

[affected]
#arch = ["x86"]
#os = ["windows"]

#[affected.functions]
#"crate_name::MyStruct::vulnerable_fn" = [">= 1.3.0, < 1.3.4"]
```

# Pingora Request Smuggling and Cache Poisoning

Pingora versions prior to 0.5.0 which used the caching functionality in pingora-cache did not properly drain the downstream request body on cache hits.

This allows an attacker to craft malicious requests which could lead to request smuggling or cache poisoning.

This flaw was corrected in commit fda3317ec822678564d641e7cf1c9b77ee3759ff by ensuring that the downstream request body is always drained before a connection can be reused.

See [the blog post](https://blog.cloudflare.com/resolving-a-request-smuggling-vulnerability-in-pingora/) for more information.
